import{s as G,v as P,x as L,y as N,a as B,_ as U,u as q,r as g,z,d as E,e as T,f as x,h as m,w as h,m as M,F as R,i as $,k as w,t as A,l as j,G as K}from"./index-f4823431.js";import{E as Y,a as J}from"./tab-pane-49513eff.js";import{E as Q,a as W}from"./breadcrumb-item-abc5a501.js";import{g as X}from"./scroll-a46a0307.js";const F=e=>{let a=0,t=e;for(;t;)a+=t.offsetTop,t=t.offsetParent;return a},Z=(e,a)=>Math.abs(F(e)-F(a)),u="ElInfiniteScroll",ee=50,te=200,ae=0,se={delay:{type:Number,default:te},distance:{type:Number,default:ae},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},I=(e,a)=>Object.entries(se).reduce((t,[s,o])=>{var n,l;const{type:b,default:r}=o,i=e.getAttribute(`infinite-scroll-${s}`);let c=(l=(n=a[i])!=null?n:i)!=null?l:r;return c=c==="false"?!1:c,c=b(c),t[s]=Number.isNaN(c)?r:c,t},{}),H=e=>{const{observer:a}=e[u];a&&(a.disconnect(),delete e[u].observer)},oe=(e,a)=>{const{container:t,containerEl:s,instance:o,observer:n,lastScrollTop:l}=e[u],{disabled:b,distance:r}=I(e,o),{clientHeight:i,scrollHeight:c,scrollTop:p}=s,f=p-l;if(e[u].lastScrollTop=p,n||b||f<0)return;let d=!1;if(t===e)d=c-(i+p)<=r;else{const{clientTop:_,scrollHeight:S}=e,v=Z(e,s);d=p+i>=v+_+S-r}d&&a.call(o)};function C(e,a){const{containerEl:t,instance:s}=e[u],{disabled:o}=I(e,s);o||t.clientHeight===0||(t.scrollHeight<=t.clientHeight?a.call(s):H(e))}const ne={async mounted(e,a){const{instance:t,value:s}=a;G(s)||P(u,"'v-infinite-scroll' binding value must be a function"),await L();const{delay:o,immediate:n}=I(e,t),l=X(e,!0),b=l===window?document.documentElement:l,r=N(oe.bind(null,e,s),o);if(l){if(e[u]={instance:t,container:l,containerEl:b,delay:o,cb:s,onScroll:r,lastScrollTop:b.scrollTop},n){const i=new MutationObserver(N(C.bind(null,e,s),ee));e[u].observer=i,i.observe(e,{childList:!0,subtree:!0}),C(e,s)}l.addEventListener("scroll",r)}},unmounted(e){const{container:a,onScroll:t}=e[u];a==null||a.removeEventListener("scroll",t),H(e)},async updated(e){if(!e[u])await L();else{const{containerEl:a,cb:t,observer:s}=e[u];a.clientHeight&&s&&C(e,t)}}},D=ne;D.install=e=>{e.directive("InfiniteScroll",D)};const le=D;const re=e=>B({url:"/category/sub/filter",params:{id:e}}),V=e=>B({method:"post",url:"/category/goods/temporary",data:e});const ie={class:"container"},ce={class:"bread-container"},ue={class:"sub-container"},de=["infinite-scroll-disabled"],fe={__name:"index",setup(e){const a=q(),t=g({});(async f=>{const{result:d}=await re(f);t.value=d})(a.params.subId);const o=g([]),n=g({categoryId:a.params.subId,page:1,pageSize:20,sortField:"publishTime"}),l=async()=>{const{result:f}=await V(n.value);o.value=f.items};l();const b=()=>{n.value.page=1,l()},r=g(!1),i=g(!1),c=z(()=>r.value||i.value),p=async()=>{r.value=!0,n.value.page++;const{result:f}=await V(n.value),d=f.items;o.value=[...o.value,...d],r.value=!1,n.value.page>=f.pages&&(i.value=!0)};return(f,d)=>{const _=W,S=Q,v=J,k=Y,O=le;return E(),T("div",ie,[x("div",ce,[m(S,{separator:">"},{default:h(()=>[m(_,{to:"/"},{default:h(()=>[w("首页")]),_:1}),m(_,{to:`/category/${t.value.parentId}`},{default:h(()=>[w(A(t.value.parentName),1)]),_:1},8,["to"]),m(_,null,{default:h(()=>[w(A(t.value.name),1)]),_:1})]),_:1})]),x("div",ue,[m(k,{modelValue:n.value.sortField,"onUpdate:modelValue":d[0]||(d[0]=y=>n.value.sortField=y),onTabChange:b},{default:h(()=>[m(v,{label:"最新商品",name:"publishTime"}),m(v,{label:"最高人气",name:"orderNum"}),m(v,{label:"评论最多",name:"evaluateNum"})]),_:1},8,["modelValue"]),M((E(),T("div",{class:"body","infinite-scroll-disabled":c.value},[(E(!0),T(R,null,$(o.value,y=>(E(),j(K,{key:y.id,"goods-item":y},null,8,["goods-item"]))),128))],8,de)),[[O,p]])])])}}},ve=U(fe,[["__scopeId","data-v-aeffa9e3"]]);export{ve as default};
